"use client"
import { useOnboardingStore } from "@/lib/store/onboarding-store";
import { getBrandColors, getPrimaryBrand } from "@/lib/colors/automotive-brands";
import { Button } from "@/components/ui/button";
import { Card } from "@/components/ui/card";
import Link from "next/link";
import { cn } from "@/lib/utils";
import {
    Phone,
    Mail,
    MapPin,
    Clock,
    ChevronRight,
    Star,
    Car,
    Wrench,
    Shield,
    CreditCard,
    ArrowRight,
    Facebook,
    Twitter,
    Instagram,
    Search,
    Calendar,
    MessageSquare,
} from "lucide-react";

// Mock OEM data (would be scraped in production)
const OEM_MODELS = {
    Toyota: [
        { name: "2026 Camry", price: "$28,855", image: "üöó", mpg: "39 MPG", type: "Sedan" },
        { name: "2026 RAV4", price: "$32,150", image: "üöô", mpg: "35 MPG", type: "SUV" },
        { name: "2026 Highlander", price: "$40,220", image: "üöê", mpg: "28 MPG", type: "SUV" },
    ],
    Honda: [
        { name: "2026 Accord", price: "$29,610", image: "üèéÔ∏è", mpg: "38 MPG", type: "Sedan" },
        { name: "2026 CR-V", price: "$32,450", image: "üöô", mpg: "33 MPG", type: "SUV" },
        { name: "2026 Pilot", price: "$42,875", image: "üöê", mpg: "26 MPG", type: "SUV" },
    ],
    Ford: [
        { name: "2026 F-150", price: "$36,500", image: "üõª", mpg: "24 MPG", type: "Truck" },
        { name: "2026 Explorer", price: "$38,355", image: "üöô", mpg: "27 MPG", type: "SUV" },
        { name: "2026 Mustang", price: "$32,515", image: "üèéÔ∏è", mpg: "25 MPG", type: "Sports" },
    ],
    BMW: [
        { name: "2026 3 Series", price: "$46,300", image: "üèÅ", mpg: "33 MPG", type: "Sedan" },
        { name: "2026 X5", price: "$65,200", image: "üöô", mpg: "26 MPG", type: "SUV" },
        { name: "2026 5 Series", price: "$58,900", image: "‚≠ê", mpg: "30 MPG", type: "Sedan" },
    ],
    "Mercedes-Benz": [
        { name: "2026 C-Class", price: "$47,800", image: "‚≠ê", mpg: "32 MPG", type: "Sedan" },
        { name: "2026 GLC", price: "$52,500", image: "üöô", mpg: "28 MPG", type: "SUV" },
        { name: "2026 E-Class", price: "$62,350", image: "üíé", mpg: "29 MPG", type: "Sedan" },
    ],
};

// Mock used inventory
const USED_INVENTORY = [
    { id: 1, name: "2020 Honda Accord EX", price: "$18,500", mileage: "32,450 mi", image: "üöó", color: "Silver" },
    { id: 2, name: "2019 Toyota Camry LE", price: "$16,200", mileage: "45,890 mi", image: "üöô", color: "White" },
    { id: 3, name: "2021 BMW 3 Series", price: "$28,900", mileage: "18,200 mi", image: "üèéÔ∏è", color: "Black" },
    { id: 4, name: "2022 Ford F-150 XLT", price: "$38,900", mileage: "12,500 mi", image: "üõª", color: "Blue" },
];

export default function PreviewPage() {
    const { data, getDealerType } = useOnboardingStore();
    const dealerType = getDealerType();

    // Get official brand colors based on selected brands
    const primaryBrand = getPrimaryBrand(data.brands || []);
    const brandColors = getBrandColors(primaryBrand);

    // Get models for selected brands
    const getNewCarModels = () => {
        if (!data.brands) return [];
        return data.brands.flatMap(brand =>
            (OEM_MODELS[brand as keyof typeof OEM_MODELS] || []).map(model => ({ ...model, brand }))
        );
    };

    const newCarModels = getNewCarModels();
    const showNewCars = data.sellsNewCars && newCarModels.length > 0;
    const showUsedCars = data.sellsUsedCars;

    return (
        <div className={cn("min-h-screen", `bg-white text-black`)}>
            {/* Preview Banner */}
            <div className="bg-blue-600 text-white text-center py-2 px-4 text-sm">
                <span className="font-medium">Preview Mode</span> ‚Äî This is how your customers will see your website
                <Link href="/dashboard" className="ml-4 underline hover:no-underline">
                    ‚Üê Back to Dashboard
                </Link>
            </div>

            {/* Header */}
            <header className="border-b border-white/10">
                <div className="max-w-7xl mx-auto px-6 py-4">
                    <div className="flex items-center justify-between">
                        {/* Logo */}
                        <div className="flex items-center gap-3">
                            <div className={cn("w-12 h-12 rounded-xl bg-gradient-to-br flex items-center justify-center", brandColors.gradient)}>
                                <Car className="w-7 h-7 text-white" />
                            </div>
                            <div>
                                <h1 className="text-xl font-bold">{data.dealershipName || "Your Dealership"}</h1>
                                <p className="text-xs text-white/60">{data.location || "Your City, State"}</p>
                            </div>
                        </div>

                        {/* Nav */}
                        <nav className="hidden md:flex items-center gap-8">
                            {showNewCars && <a href="#new-cars" className="text-sm text-white/80 hover:text-white transition-colors">New Cars</a>}
                            {showUsedCars && <a href="#used-cars" className="text-sm text-white/80 hover:text-white transition-colors">Used Cars</a>}
                            <a href="#services" className="text-sm text-white/80 hover:text-white transition-colors">Services</a>
                            <a href="#about" className="text-sm text-white/80 hover:text-white transition-colors">About Us</a>
                            <a href="#contact" className="text-sm text-white/80 hover:text-white transition-colors">Contact</a>
                        </nav>

                        {/* Contact */}
                        <div className="flex items-center gap-4">
                            <a href={`tel:${data.phone}`} className={cn("hidden md:flex items-center gap-2 text-sm font-medium", brandColors.gradientText)}>
                                <Phone className="w-4 h-4" />
                                {data.phone || "(555) 123-4567"}
                            </a>
                            <button className={cn("px-4 py-2 rounded-lg text-sm font-semibold text-white transition-colors", `bg-[${brandColors.primary}] hover:bg-[${brandColors.hover}]`)}>
                                Get Quote
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            {/* Hero Section */}
            <section className="py-20 px-6">
                <div className="max-w-7xl mx-auto text-center">
                    <h2 className="text-5xl md:text-6xl font-bold mb-6">
                        Welcome to<br />
                        <span className={cn("bg-gradient-to-r bg-clip-text text-transparent", brandColors.gradient)}>
                            {data.dealershipName || "Your Dealership"}
                        </span>
                    </h2>
                    <p className="text-xl text-white/70 max-w-2xl mx-auto mb-8">
                        {data.yearsInBusiness
                            ? `Serving ${data.location || "our community"} for over ${data.yearsInBusiness} years with quality vehicles and exceptional service.`
                            : `Your trusted destination for quality vehicles in ${data.location || "our community"}. Experience the difference today.`
                        }
                    </p>
                    <div className="flex flex-wrap justify-center gap-4">
                        <button className={cn("px-8 py-4 rounded-xl text-lg font-semibold text-white transition-colors", `bg-[${brandColors.primary}] hover:bg-[${brandColors.hover}]`)}>
                            <Calendar className="inline w-5 h-5 mr-2" />
                            Schedule Test Drive
                        </button>
                        <button className="px-8 py-4 rounded-xl text-lg font-semibold border-2 border-white/20 hover:bg-white/10 transition-colors">
                            <Search className="inline w-5 h-5 mr-2" />
                            Browse Inventory
                        </button>
                    </div>

                    {/* Brand Badges - for OEM dealers */}
                    {showNewCars && data.brands && data.brands.length > 0 && (
                        <div className="mt-12">
                            <p className="text-sm text-white/50 mb-4">Authorized Dealer For</p>
                            <div className="flex justify-center gap-6">
                                {data.brands.map(brand => (
                                    <div key={brand} className="px-6 py-3 rounded-xl bg-white/5 border border-white/10">
                                        <span className="font-semibold">{brand}</span>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}
                </div>
            </section>

            {/* New Cars Section - OEM Dealers */}
            {showNewCars && (
                <section id="new-cars" className="py-16 px-6 bg-black/20">
                    <div className="max-w-7xl mx-auto">
                        <div className="text-center mb-12">
                            <h3 className="text-3xl font-bold mb-3">2026 New Models</h3>
                            <p className="text-white/60">Explore our latest lineup of brand new vehicles</p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {newCarModels.slice(0, 6).map((model, index) => (
                                <div key={index} className="bg-white/5 border border-white/10 rounded-2xl overflow-hidden hover:bg-white/10 transition-colors">
                                    <div className="h-48 bg-gradient-to-br from-white/5 to-white/0 flex items-center justify-center text-7xl">
                                        {model.image}
                                    </div>
                                    <div className="p-6">
                                        <p className="text-xs text-white/50 mb-1">{model.brand}</p>
                                        <h4 className="text-xl font-bold mb-2">{model.name}</h4>
                                        <p className={cn("text-2xl font-bold mb-3", brandColors.gradientText)}>Starting at {model.price}</p>
                                        <div className="flex items-center gap-4 text-sm text-white/60 mb-4">
                                            <span>{model.mpg}</span>
                                            <span>‚Ä¢</span>
                                            <span>{model.type}</span>
                                        </div>
                                        <div className="flex gap-2">
                                            <button className={cn("flex-1 py-2 rounded-lg text-sm font-semibold text-white transition-colors", `bg-[${brandColors.primary}] hover:bg-[${brandColors.hover}]`)}>
                                                Get Quote
                                            </button>
                                            <button className="flex-1 py-2 rounded-lg text-sm font-semibold border border-white/20 hover:bg-white/10 transition-colors">
                                                Details
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </section>
            )}

            {/* Used Cars Section */}
            {showUsedCars && (
                <section id="used-cars" className="py-16 px-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="text-center mb-12">
                            <h3 className="text-3xl font-bold mb-3">Pre-Owned Vehicles</h3>
                            <p className="text-white/60">Quality used cars at competitive prices</p>
                        </div>

                        {/* Search Bar */}
                        <div className="bg-white/5 border border-white/10 rounded-2xl p-6 mb-8">
                            <div className="flex flex-wrap gap-4">
                                <select className="flex-1 min-w-[150px] px-4 py-3 rounded-xl bg-white/10 border border-white/10 text-white">
                                    <option>All Makes</option>
                                    <option>Honda</option>
                                    <option>Toyota</option>
                                    <option>Ford</option>
                                </select>
                                <select className="flex-1 min-w-[150px] px-4 py-3 rounded-xl bg-white/10 border border-white/10 text-white">
                                    <option>All Models</option>
                                </select>
                                <select className="flex-1 min-w-[150px] px-4 py-3 rounded-xl bg-white/10 border border-white/10 text-white">
                                    <option>Any Price</option>
                                    <option>Under $15,000</option>
                                    <option>$15,000 - $25,000</option>
                                    <option>Over $25,000</option>
                                </select>
                                <button className={cn("px-8 py-3 rounded-xl font-semibold text-white transition-colors", `bg-[${brandColors.primary}] hover:bg-[${brandColors.hover}]`)}>
                                    <Search className="inline w-4 h-4 mr-2" />
                                    Search
                                </button>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            {USED_INVENTORY.map((car) => (
                                <div key={car.id} className="bg-white/5 border border-white/10 rounded-2xl overflow-hidden hover:bg-white/10 transition-colors">
                                    <div className="h-40 bg-gradient-to-br from-white/5 to-white/0 flex items-center justify-center text-6xl">
                                        {car.image}
                                    </div>
                                    <div className="p-5">
                                        <h4 className="font-bold mb-1">{car.name}</h4>
                                        <p className={cn("text-xl font-bold mb-2", brandColors.gradientText)}>{car.price}</p>
                                        <div className="flex items-center gap-2 text-sm text-white/60 mb-4">
                                            <span>{car.mileage}</span>
                                            <span>‚Ä¢</span>
                                            <span>{car.color}</span>
                                        </div>
                                        <button className={cn("w-full py-2 rounded-lg text-sm font-semibold text-white transition-colors", `bg-[${brandColors.primary}] hover:bg-[${brandColors.hover}]`)}>
                                            View Details
                                        </button>
                                    </div>
                                </div>
                            ))}
                        </div>

                        <div className="text-center mt-8">
                            <button className="px-8 py-3 rounded-xl font-semibold border-2 border-white/20 hover:bg-white/10 transition-colors">
                                View All {USED_INVENTORY.length}+ Vehicles
                                <ArrowRight className="inline w-4 h-4 ml-2" />
                            </button>
                        </div>
                    </div>
                </section>
            )}

            {/* Services Section */}
            <section id="services" className="py-16 px-6 bg-black/20">
                <div className="max-w-7xl mx-auto">
                    <div className="text-center mb-12">
                        <h3 className="text-3xl font-bold mb-3">Our Services</h3>
                        <p className="text-white/60">Everything you need, all in one place</p>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                        {data.services?.includes("service_maintenance") && (
                            <div className="bg-white/5 border border-white/10 rounded-2xl p-6 text-center hover:bg-white/10 transition-colors">
                                <Wrench className={cn("w-12 h-12 mx-auto mb-4", brandColors.gradientText)} />
                                <h4 className="font-bold mb-2">Service & Maintenance</h4>
                                <p className="text-sm text-white/60">Expert care to keep your vehicle running smoothly</p>
                            </div>
                        )}
                        {data.services?.includes("financing") && (
                            <div className="bg-white/5 border border-white/10 rounded-2xl p-6 text-center hover:bg-white/10 transition-colors">
                                <CreditCard className={cn("w-12 h-12 mx-auto mb-4", brandColors.gradientText)} />
                                <h4 className="font-bold mb-2">Financing</h4>
                                <p className="text-sm text-white/60">Flexible financing options for every budget</p>
                            </div>
                        )}
                        {data.services?.includes("parts_accessories") && (
                            <div className="bg-white/5 border border-white/10 rounded-2xl p-6 text-center hover:bg-white/10 transition-colors">
                                <Car className={cn("w-12 h-12 mx-auto mb-4", brandColors.gradientText)} />
                                <h4 className="font-bold mb-2">Parts & Accessories</h4>
                                <p className="text-sm text-white/60">Genuine parts and premium accessories</p>
                            </div>
                        )}
                        {data.services?.includes("trade_in") && (
                            <div className="bg-white/5 border border-white/10 rounded-2xl p-6 text-center hover:bg-white/10 transition-colors">
                                <Shield className={cn("w-12 h-12 mx-auto mb-4", brandColors.gradientText)} />
                                <h4 className="font-bold mb-2">Trade-In</h4>
                                <p className="text-sm text-white/60">Get top dollar for your current vehicle</p>
                            </div>
                        )}
                    </div>
                </div>
            </section>

            {/* About Section */}
            <section id="about" className="py-16 px-6">
                <div className="max-w-4xl mx-auto text-center">
                    <h3 className="text-3xl font-bold mb-6">About {data.dealershipName || "Us"}</h3>
                    <p className="text-lg text-white/70 leading-relaxed">
                        Welcome to {data.dealershipName || "our dealership"}, your trusted automotive partner in {data.location || "the community"}.
                        {data.yearsInBusiness && ` With over ${data.yearsInBusiness} years of experience,`} we pride ourselves on
                        delivering exceptional service and quality vehicles. Our dedicated team is committed to helping you find the
                        perfect car that fits your lifestyle and budget.
                    </p>

                    {/* Stats */}
                    <div className="grid grid-cols-3 gap-8 mt-12">
                        <div>
                            <p className={cn("text-4xl font-bold", brandColors.gradientText)}>{data.yearsInBusiness || "20"}+</p>
                            <p className="text-white/60">Years in Business</p>
                        </div>
                        <div>
                            <p className={cn("text-4xl font-bold", brandColors.gradientText)}>4.8</p>
                            <p className="text-white/60">Customer Rating</p>
                        </div>
                        <div>
                            <p className={cn("text-4xl font-bold", brandColors.gradientText)}>1000+</p>
                            <p className="text-white/60">Happy Customers</p>
                        </div>
                    </div>
                </div>
            </section>

            {/* Contact Section */}
            <section id="contact" className="py-16 px-6 bg-black/20">
                <div className="max-w-7xl mx-auto">
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-12">
                        {/* Contact Info */}
                        <div>
                            <h3 className="text-3xl font-bold mb-6">Get In Touch</h3>
                            <div className="space-y-6">
                                <div className="flex items-start gap-4">
                                    <MapPin className={cn("w-6 h-6 mt-1", brandColors.gradientText)} />
                                    <div>
                                        <p className="font-semibold">Location</p>
                                        <p className="text-white/60">123 Main Street, {data.location || "Your City, State"}</p>
                                    </div>
                                </div>
                                <div className="flex items-start gap-4">
                                    <Phone className={cn("w-6 h-6 mt-1", brandColors.gradientText)} />
                                    <div>
                                        <p className="font-semibold">Phone</p>
                                        <p className="text-white/60">{data.phone || "(555) 123-4567"}</p>
                                    </div>
                                </div>
                                <div className="flex items-start gap-4">
                                    <Mail className={cn("w-6 h-6 mt-1", brandColors.gradientText)} />
                                    <div>
                                        <p className="font-semibold">Email</p>
                                        <p className="text-white/60">{data.email || "info@dealer.com"}</p>
                                    </div>
                                </div>
                                <div className="flex items-start gap-4">
                                    <Clock className={cn("w-6 h-6 mt-1", brandColors.gradientText)} />
                                    <div>
                                        <p className="font-semibold">Hours</p>
                                        <p className="text-white/60">Mon-Sat: 9am - 7pm</p>
                                        <p className="text-white/60">Sunday: 10am - 5pm</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Contact Form */}
                        <div className="bg-white/5 border border-white/10 rounded-2xl p-8">
                            <h4 className="text-xl font-bold mb-6">Send Us a Message</h4>
                            <div className="space-y-4">
                                <input
                                    type="text"
                                    placeholder="Your Name"
                                    className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/10 placeholder:text-white/40"
                                />
                                <input
                                    type="email"
                                    placeholder="Email Address"
                                    className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/10 placeholder:text-white/40"
                                />
                                <input
                                    type="tel"
                                    placeholder="Phone Number"
                                    className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/10 placeholder:text-white/40"
                                />
                                <textarea
                                    placeholder="How can we help you?"
                                    rows={4}
                                    className="w-full px-4 py-3 rounded-xl bg-white/10 border border-white/10 placeholder:text-white/40 resize-none"
                                />
                                <button className={cn("w-full py-3 rounded-xl font-semibold text-white transition-colors", `bg-[${brandColors.primary}] hover:bg-[${brandColors.hover}]`)}>
                                    <MessageSquare className="inline w-4 h-4 mr-2" />
                                    Send Message
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            {/* Footer */}
            <footer className="py-12 px-6 border-t border-white/10">
                <div className="max-w-7xl mx-auto">
                    <div className="flex flex-col md:flex-row items-center justify-between gap-6">
                        <div className="flex items-center gap-3">
                            <div className={cn("w-10 h-10 rounded-xl bg-gradient-to-br flex items-center justify-center", brandColors.gradient)}>
                                <Car className="w-6 h-6 text-white" />
                            </div>
                            <span className="font-bold">{data.dealershipName || "Your Dealership"}</span>
                        </div>

                        <div className="flex items-center gap-6">
                            <a href="#" className="p-2 rounded-lg hover:bg-white/10 transition-colors">
                                <Facebook className="w-5 h-5" />
                            </a>
                            <a href="#" className="p-2 rounded-lg hover:bg-white/10 transition-colors">
                                <Twitter className="w-5 h-5" />
                            </a>
                            <a href="#" className="p-2 rounded-lg hover:bg-white/10 transition-colors">
                                <Instagram className="w-5 h-5" />
                            </a>
                        </div>

                        <p className="text-sm text-white/50">
                            ¬© 2026 {data.dealershipName || "Your Dealership"}. Powered by DealerSite Pro.
                        </p>
                    </div>
                </div>
            </footer>
        </div>
    );
}
