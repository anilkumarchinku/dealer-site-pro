"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/dashboard/reviews/page",{

/***/ "(app-pages-browser)/./lib/db/reviews.ts":
/*!***************************!*\
  !*** ./lib/db/reviews.ts ***!
  \***************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   computeReviewStats: () => (/* binding */ computeReviewStats),\n/* harmony export */   fetchReviews: () => (/* binding */ fetchReviews),\n/* harmony export */   respondToReview: () => (/* binding */ respondToReview)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase */ \"(app-pages-browser)/./lib/supabase.ts\");\n/* __next_internal_client_entry_do_not_use__ fetchReviews,respondToReview,computeReviewStats auto */ \n// ── Normalize DB row → UI shape ───────────────────────────────\nfunction normalize(row) {\n    return {\n        ...row,\n        review_text: row.content,\n        dealer_response: row.admin_reply,\n        platform: row.source,\n        is_published: row.status === \"published\"\n    };\n}\n// ── Fetch published reviews for a dealer ─────────────────────\nasync function fetchReviews(dealerId) {\n    if (!(0,_lib_supabase__WEBPACK_IMPORTED_MODULE_0__.isSupabaseReady)()) return [];\n    const { data, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"reviews\").select(\"*\").eq(\"dealer_id\", dealerId).eq(\"status\", \"published\").order(\"created_at\", {\n        ascending: false\n    });\n    if (error) {\n        console.error(\"[fetchReviews]\", error.message);\n        return [];\n    }\n    return (data !== null && data !== void 0 ? data : []).map(normalize);\n}\n// ── Save dealer response to a review ─────────────────────────\nasync function respondToReview(reviewId, responseText) {\n    if (!(0,_lib_supabase__WEBPACK_IMPORTED_MODULE_0__.isSupabaseReady)()) return {\n        success: false,\n        error: \"Supabase not configured\"\n    };\n    const { error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"reviews\").update({\n        admin_reply: responseText,\n        replied_at: new Date().toISOString(),\n        status: \"published\"\n    }).eq(\"id\", reviewId);\n    if (error) return {\n        success: false,\n        error: error.message\n    };\n    return {\n        success: true\n    };\n}\n// ── Compute avg rating + total from an array (used for UI) ───\nfunction computeReviewStats(reviews) {\n    if (reviews.length === 0) return {\n        avgRating: 0,\n        total: 0,\n        responded: 0\n    };\n    const avg = reviews.reduce((s, r)=>s + r.rating, 0) / reviews.length;\n    const responded = reviews.filter((r)=>{\n        var _r_admin_reply;\n        return !!((_r_admin_reply = r.admin_reply) !== null && _r_admin_reply !== void 0 ? _r_admin_reply : r.dealer_response);\n    }).length;\n    return {\n        avgRating: parseFloat(avg.toFixed(1)),\n        total: reviews.length,\n        responded\n    };\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2xpYi9kYi9yZXZpZXdzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7cUdBRTJEO0FBMEIzRCxpRUFBaUU7QUFDakUsU0FBU0UsVUFBVUMsR0FBNEI7SUFDM0MsT0FBTztRQUNILEdBQUlBLEdBQUc7UUFDUEMsYUFBaUJELElBQUlFLE9BQU87UUFDNUJDLGlCQUFpQkgsSUFBSUksV0FBVztRQUNoQ0MsVUFBaUJMLElBQUlNLE1BQU07UUFDM0JDLGNBQWlCUCxJQUFJUSxNQUFNLEtBQUs7SUFDcEM7QUFDSjtBQUVBLGdFQUFnRTtBQUN6RCxlQUFlQyxhQUFhQyxRQUFnQjtJQUMvQyxJQUFJLENBQUNaLDhEQUFlQSxJQUFJLE9BQU8sRUFBRTtJQUVqQyxNQUFNLEVBQUVhLElBQUksRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTWYsbURBQVFBLENBQ2pDZ0IsSUFBSSxDQUFDLFdBQ0xDLE1BQU0sQ0FBQyxLQUNQQyxFQUFFLENBQUMsYUFBYUwsVUFDaEJLLEVBQUUsQ0FBQyxVQUFVLGFBQ2JDLEtBQUssQ0FBQyxjQUFjO1FBQUVDLFdBQVc7SUFBTTtJQUU1QyxJQUFJTCxPQUFPO1FBQ1BNLFFBQVFOLEtBQUssQ0FBQyxrQkFBa0JBLE1BQU1PLE9BQU87UUFDN0MsT0FBTyxFQUFFO0lBQ2I7SUFDQSxPQUFPLENBQUNSLGlCQUFBQSxrQkFBQUEsT0FBUSxFQUFFLEVBQUVTLEdBQUcsQ0FBQ3JCO0FBQzVCO0FBRUEsZ0VBQWdFO0FBQ3pELGVBQWVzQixnQkFDbEJDLFFBQWdCLEVBQ2hCQyxZQUFvQjtJQUVwQixJQUFJLENBQUN6Qiw4REFBZUEsSUFBSSxPQUFPO1FBQUUwQixTQUFTO1FBQU9aLE9BQU87SUFBMEI7SUFFbEYsTUFBTSxFQUFFQSxLQUFLLEVBQUUsR0FBRyxNQUFNZixtREFBUUEsQ0FDM0JnQixJQUFJLENBQUMsV0FDTFksTUFBTSxDQUFDO1FBQ0pyQixhQUFhbUI7UUFDYkcsWUFBYSxJQUFJQyxPQUFPQyxXQUFXO1FBQ25DcEIsUUFBYTtJQUNqQixHQUNDTyxFQUFFLENBQUMsTUFBTU87SUFFZCxJQUFJVixPQUFPLE9BQU87UUFBRVksU0FBUztRQUFPWixPQUFPQSxNQUFNTyxPQUFPO0lBQUM7SUFDekQsT0FBTztRQUFFSyxTQUFTO0lBQUs7QUFDM0I7QUFFQSxnRUFBZ0U7QUFDekQsU0FBU0ssbUJBQW1CQyxPQUFtQjtJQUNsRCxJQUFJQSxRQUFRQyxNQUFNLEtBQUssR0FBRyxPQUFPO1FBQUVDLFdBQVc7UUFBR0MsT0FBTztRQUFHQyxXQUFXO0lBQUU7SUFDeEUsTUFBTUMsTUFBTUwsUUFBUU0sTUFBTSxDQUFDLENBQUNDLEdBQUdDLElBQU1ELElBQUlDLEVBQUVDLE1BQU0sRUFBRSxLQUFLVCxRQUFRQyxNQUFNO0lBQ3RFLE1BQU1HLFlBQVlKLFFBQVFVLE1BQU0sQ0FBQyxDQUFDRjtZQUFTQTtlQUFILENBQUMsQ0FBRUEsQ0FBQUEsQ0FBQUEsaUJBQUFBLEVBQUVsQyxXQUFXLGNBQWJrQyw0QkFBQUEsaUJBQWlCQSxFQUFFbkMsZUFBZTtPQUFHNEIsTUFBTTtJQUN0RixPQUFPO1FBQ0hDLFdBQVdTLFdBQVdOLElBQUlPLE9BQU8sQ0FBQztRQUNsQ1QsT0FBV0gsUUFBUUMsTUFBTTtRQUN6Qkc7SUFDSjtBQUNKIiwic291cmNlcyI6WyIvVXNlcnMvYW5pbGt1bWFya29sdWt1bGFwYWxsaS9wcm9qZWN0cy9jeWVwcm8vZGVhbGVyc2l0ZSBwcm8vZGVhbGVyLXNpdGUtcHJvL2xpYi9kYi9yZXZpZXdzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgeyBzdXBhYmFzZSwgaXNTdXBhYmFzZVJlYWR5IH0gZnJvbSBcIkAvbGliL3N1cGFiYXNlXCI7XG5cbi8vIE1hdGNoZXMgYWN0dWFsIERCIGNvbHVtbnMgaW4gYHJldmlld3NgIHRhYmxlXG5leHBvcnQgaW50ZXJmYWNlIERCUmV2aWV3IHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGRlYWxlcl9pZDogc3RyaW5nO1xuICAgIGN1c3RvbWVyX25hbWU6IHN0cmluZztcbiAgICBjdXN0b21lcl9lbWFpbD86IHN0cmluZztcbiAgICByYXRpbmc6IG51bWJlcjsgICAgICAgICAgIC8vIDHigJM1XG4gICAgdGl0bGU/OiBzdHJpbmc7XG4gICAgY29udGVudD86IHN0cmluZzsgICAgICAgICAvLyBEQiBjb2x1bW4gbmFtZVxuICAgIHN0YXR1czogc3RyaW5nOyAgICAgICAgICAgLy8gJ3BlbmRpbmcnIHwgJ3B1Ymxpc2hlZCcgfCAncmVqZWN0ZWQnXG4gICAgaXNfZmVhdHVyZWQ6IGJvb2xlYW47XG4gICAgYWRtaW5fcmVwbHk/OiBzdHJpbmc7ICAgICAvLyBEQiBjb2x1bW4gbmFtZSBmb3IgZGVhbGVyIHJlc3BvbnNlXG4gICAgcmVwbGllZF9hdD86IHN0cmluZztcbiAgICBzb3VyY2U6IHN0cmluZzsgICAgICAgICAgIC8vICd3ZWJzaXRlJyB8ICdnb29nbGUnIHwgJ2ZhY2Vib29rJyB8ICdqdXN0ZGlhbCcgfCAnY2FyZGVraG8nXG4gICAgY3JlYXRlZF9hdDogc3RyaW5nO1xuICAgIHVwZGF0ZWRfYXQ6IHN0cmluZztcblxuICAgIC8vIENvbnZlbmllbmNlIGFsaWFzZXMgdXNlZCBpbiB0aGUgVUlcbiAgICByZXZpZXdfdGV4dD86IHN0cmluZzsgICAgIC8vIGFsaWFzIGZvciBjb250ZW50XG4gICAgZGVhbGVyX3Jlc3BvbnNlPzogc3RyaW5nOyAvLyBhbGlhcyBmb3IgYWRtaW5fcmVwbHlcbiAgICBwbGF0Zm9ybT86IHN0cmluZzsgICAgICAgIC8vIGFsaWFzIGZvciBzb3VyY2VcbiAgICBpc19wdWJsaXNoZWQ/OiBib29sZWFuOyAgIC8vIGRlcml2ZWQgZnJvbSBzdGF0dXMgPT09ICdwdWJsaXNoZWQnXG59XG5cbi8vIOKUgOKUgCBOb3JtYWxpemUgREIgcm93IOKGkiBVSSBzaGFwZSDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbmZ1bmN0aW9uIG5vcm1hbGl6ZShyb3c6IFJlY29yZDxzdHJpbmcsIHVua25vd24+KTogREJSZXZpZXcge1xuICAgIHJldHVybiB7XG4gICAgICAgIC4uLihyb3cgYXMgREJSZXZpZXcpLFxuICAgICAgICByZXZpZXdfdGV4dDogICAgIHJvdy5jb250ZW50IGFzIHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgICAgICAgZGVhbGVyX3Jlc3BvbnNlOiByb3cuYWRtaW5fcmVwbHkgYXMgc3RyaW5nIHwgdW5kZWZpbmVkLFxuICAgICAgICBwbGF0Zm9ybTogICAgICAgIHJvdy5zb3VyY2UgYXMgc3RyaW5nIHwgdW5kZWZpbmVkLFxuICAgICAgICBpc19wdWJsaXNoZWQ6ICAgIHJvdy5zdGF0dXMgPT09IFwicHVibGlzaGVkXCIsXG4gICAgfTtcbn1cblxuLy8g4pSA4pSAIEZldGNoIHB1Ymxpc2hlZCByZXZpZXdzIGZvciBhIGRlYWxlciDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIBcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaFJldmlld3MoZGVhbGVySWQ6IHN0cmluZyk6IFByb21pc2U8REJSZXZpZXdbXT4ge1xuICAgIGlmICghaXNTdXBhYmFzZVJlYWR5KCkpIHJldHVybiBbXTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKFwicmV2aWV3c1wiKVxuICAgICAgICAuc2VsZWN0KFwiKlwiKVxuICAgICAgICAuZXEoXCJkZWFsZXJfaWRcIiwgZGVhbGVySWQpXG4gICAgICAgIC5lcShcInN0YXR1c1wiLCBcInB1Ymxpc2hlZFwiKVxuICAgICAgICAub3JkZXIoXCJjcmVhdGVkX2F0XCIsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiW2ZldGNoUmV2aWV3c11cIiwgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gICAgcmV0dXJuIChkYXRhID8/IFtdKS5tYXAobm9ybWFsaXplKTtcbn1cblxuLy8g4pSA4pSAIFNhdmUgZGVhbGVyIHJlc3BvbnNlIHRvIGEgcmV2aWV3IOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgFxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlc3BvbmRUb1JldmlldyhcbiAgICByZXZpZXdJZDogc3RyaW5nLFxuICAgIHJlc3BvbnNlVGV4dDogc3RyaW5nXG4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgZXJyb3I/OiBzdHJpbmcgfT4ge1xuICAgIGlmICghaXNTdXBhYmFzZVJlYWR5KCkpIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJTdXBhYmFzZSBub3QgY29uZmlndXJlZFwiIH07XG5cbiAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbShcInJldmlld3NcIilcbiAgICAgICAgLnVwZGF0ZSh7XG4gICAgICAgICAgICBhZG1pbl9yZXBseTogcmVzcG9uc2VUZXh0LFxuICAgICAgICAgICAgcmVwbGllZF9hdDogIG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgIHN0YXR1czogICAgICBcInB1Ymxpc2hlZFwiLCAgIC8vIGF1dG8tcHVibGlzaCB3aGVuIGRlYWxlciByZXBsaWVzXG4gICAgICAgIH0pXG4gICAgICAgIC5lcShcImlkXCIsIHJldmlld0lkKTtcblxuICAgIGlmIChlcnJvcikgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH07XG4gICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSB9O1xufVxuXG4vLyDilIDilIAgQ29tcHV0ZSBhdmcgcmF0aW5nICsgdG90YWwgZnJvbSBhbiBhcnJheSAodXNlZCBmb3IgVUkpIOKUgOKUgOKUgFxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVSZXZpZXdTdGF0cyhyZXZpZXdzOiBEQlJldmlld1tdKSB7XG4gICAgaWYgKHJldmlld3MubGVuZ3RoID09PSAwKSByZXR1cm4geyBhdmdSYXRpbmc6IDAsIHRvdGFsOiAwLCByZXNwb25kZWQ6IDAgfTtcbiAgICBjb25zdCBhdmcgPSByZXZpZXdzLnJlZHVjZSgocywgcikgPT4gcyArIHIucmF0aW5nLCAwKSAvIHJldmlld3MubGVuZ3RoO1xuICAgIGNvbnN0IHJlc3BvbmRlZCA9IHJldmlld3MuZmlsdGVyKChyKSA9PiAhIShyLmFkbWluX3JlcGx5ID8/IHIuZGVhbGVyX3Jlc3BvbnNlKSkubGVuZ3RoO1xuICAgIHJldHVybiB7XG4gICAgICAgIGF2Z1JhdGluZzogcGFyc2VGbG9hdChhdmcudG9GaXhlZCgxKSksXG4gICAgICAgIHRvdGFsOiAgICAgcmV2aWV3cy5sZW5ndGgsXG4gICAgICAgIHJlc3BvbmRlZCxcbiAgICB9O1xufVxuIl0sIm5hbWVzIjpbInN1cGFiYXNlIiwiaXNTdXBhYmFzZVJlYWR5Iiwibm9ybWFsaXplIiwicm93IiwicmV2aWV3X3RleHQiLCJjb250ZW50IiwiZGVhbGVyX3Jlc3BvbnNlIiwiYWRtaW5fcmVwbHkiLCJwbGF0Zm9ybSIsInNvdXJjZSIsImlzX3B1Ymxpc2hlZCIsInN0YXR1cyIsImZldGNoUmV2aWV3cyIsImRlYWxlcklkIiwiZGF0YSIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwib3JkZXIiLCJhc2NlbmRpbmciLCJjb25zb2xlIiwibWVzc2FnZSIsIm1hcCIsInJlc3BvbmRUb1JldmlldyIsInJldmlld0lkIiwicmVzcG9uc2VUZXh0Iiwic3VjY2VzcyIsInVwZGF0ZSIsInJlcGxpZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJjb21wdXRlUmV2aWV3U3RhdHMiLCJyZXZpZXdzIiwibGVuZ3RoIiwiYXZnUmF0aW5nIiwidG90YWwiLCJyZXNwb25kZWQiLCJhdmciLCJyZWR1Y2UiLCJzIiwiciIsInJhdGluZyIsImZpbHRlciIsInBhcnNlRmxvYXQiLCJ0b0ZpeGVkIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./lib/db/reviews.ts\n"));

/***/ })

});